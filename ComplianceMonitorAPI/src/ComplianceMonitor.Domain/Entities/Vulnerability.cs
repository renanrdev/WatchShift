using System;
using System.Collections.Generic;
using ComplianceMonitor.Domain.Enums;

namespace ComplianceMonitor.Domain.Entities
{
    public class Vulnerability
    {
        public Guid Id { get; private set; }
        public string PackageName { get; private set; }
        public string InstalledVersion { get; private set; }
        public string FixedVersion { get; private set; }
        public VulnerabilitySeverity Severity { get; private set; }
        public string Description { get; private set; }
        public List<string> References { get; private set; }
        public double? CvssScore { get; private set; }

        public Guid ImageScanResultId { get; private set; }

        public ImageScanResult ImageScanResult { get; private set; }

        private Vulnerability() { }

        public Vulnerability(
            Guid id,
            string packageName,
            string installedVersion,
            string fixedVersion,
            VulnerabilitySeverity severity,
            string description,
            List<string> references = null,
            double? cvssScore = null)
        {
            Id = id;
            PackageName = packageName;
            InstalledVersion = installedVersion;
            FixedVersion = fixedVersion;
            Severity = severity;
            Description = description;
            References = references ?? new List<string>();
            CvssScore = cvssScore;
        }


        public void SetImageScanResultId(Guid imageScanResultId)
        {
            ImageScanResultId = imageScanResultId;
        }
    }
}
